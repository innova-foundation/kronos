"undefined"!=typeof Crypto&&Crypto.util||function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=window.Crypto={},e=t.util={rotl:function(t,i){return t<<i|t>>>32-i},rotr:function(t,i){return t<<32-i|t>>>i},endian:function(t){if(t.constructor==Number)return 16711935&e.rotl(t,8)|4278255360&e.rotl(t,24);for(var i=0;i<t.length;i++)t[i]=e.endian(t[i]);return t},randomBytes:function(t){for(var i=[];0<t;t--)i.push(Math.floor(256*Math.random()));return i},bytesToWords:function(t){for(var i=[],e=0,r=0;e<t.length;e++,r+=8)i[r>>>5]|=(255&t[e])<<24-r%32;return i},wordsToBytes:function(t){for(var i=[],e=0;e<32*t.length;e+=8)i.push(t[e>>>5]>>>24-e%32&255);return i},bytesToHex:function(t){for(var i=[],e=0;e<t.length;e++)i.push((t[e]>>>4).toString(16)),i.push((15&t[e]).toString(16));return i.join("")},hexToBytes:function(t){for(var i=[],e=0;e<t.length;e+=2)i.push(parseInt(t.substr(e,2),16));return i},bytesToBase64:function(t){for(var i=[],e=0;e<t.length;e+=3)for(var r=t[e]<<16|t[e+1]<<8|t[e+2],o=0;o<4;o++)8*e+6*o<=8*t.length?i.push(n.charAt(r>>>6*(3-o)&63)):i.push("=");return i.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var i=[],e=0,r=0;e<t.length;r=++e%4)0!=r&&i.push((n.indexOf(t.charAt(e-1))&Math.pow(2,-2*r+8)-1)<<2*r|n.indexOf(t.charAt(e))>>>6-2*r);return i}},i=t.charenc={},r=(i.UTF8={stringToBytes:function(t){return r.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(r.bytesToString(t)))}},i.Binary={stringToBytes:function(t){for(var i=[],e=0;e<t.length;e++)i.push(255&t.charCodeAt(e));return i},bytesToString:function(t){for(var i=[],e=0;e<t.length;e++)i.push(String.fromCharCode(t[e]));return i.join("")}})}(),function(){var t=Crypto,T=t.util,i=t.charenc,I=i.UTF8,r=i.Binary,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=t.SHA256=function(t,i){var e=T.wordsToBytes(o._sha256(t));return i&&i.asBytes?e:i&&i.asString?r.bytesToString(e):T.bytesToHex(e)};o._sha256=function(t){t.constructor==String&&(t=I.stringToBytes(t));var i=T.bytesToWords(t),e=8*t.length,r=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],o=[];i[e>>5]|=128<<24-e%32,i[15+(64+e>>9<<4)]=e;for(var n=0;n<i.length;n+=16){b=r[0],F=r[1],B=r[2],v=r[3],d=r[4],m=r[5],y=r[6],g=r[7];for(var s,u,h,a,p=0;p<64;p++){p<16?o[p]=i[p+n]:(h=((s=o[p-15])<<25|s>>>7)^(s<<14|s>>>18)^s>>>3,a=((u=o[p-2])<<15|u>>>17)^(u<<13|u>>>19)^u>>>10,o[p]=h+(o[p-7]>>>0)+a+(o[p-16]>>>0));var f=b&F^b&B^F&B,c=(b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22),l=(g>>>0)+((d<<26|d>>>6)^(d<<21|d>>>11)^(d<<7|d>>>25))+(d&m^~d&y)+w[p]+(o[p]>>>0),g=y,y=m,m=d,d=v+l>>>0,v=B,B=F,F=b,b=l+(c+f)>>>0}r[0]+=b,r[1]+=F,r[2]+=B,r[3]+=v,r[4]+=d,r[5]+=m,r[6]+=y,r[7]+=g}return r},o._blocksize=16,o._digestsize=32}(),function(){var t=Crypto,I=t.util,i=t.charenc,w=i.UTF8,r=i.Binary;I.bytesToLWords=function(t){for(var i=Array(t.length>>2),e=0;e<i.length;e++)i[e]=0;for(e=0;e<8*t.length;e+=8)i[e>>5]|=(255&t[e/8])<<e%32;return i},I.lWordsToBytes=function(t){for(var i=[],e=0;e<32*t.length;e+=8)i.push(t[e>>5]>>>e%32&255);return i};var o=t.RIPEMD160=function(t,i){var e=I.lWordsToBytes(o._rmd160(t));return i&&i.asBytes?e:i&&i.asString?r.bytesToString(e):I.bytesToHex(e)};function S(t,i,e,r){return 0<=t&&t<=15?i^e^r:16<=t&&t<=31?i&e|~i&r:32<=t&&t<=47?(i|~e)^r:48<=t&&t<=63?i&r|e&~r:64<=t&&t<=79?i^(e|~r):"rmd160_f: j out of range"}o._rmd160=function(t){t.constructor==String&&(t=w.stringToBytes(t));var i=I.bytesToLWords(t),e=8*t.length;i[e>>5]|=128<<e%32,i[14+(64+e>>>9<<4)]=e;for(var r,o,n=1732584193,s=4023233417,u=2562383102,h=271733878,a=3285377520,p=0;p<i.length;p+=16){for(var f,c=n,l=s,g=u,y=h,m=a,d=n,v=s,B=u,F=h,b=a,T=0;T<=79;++T)f=D(c,S(T,l,g,y)),f=D(f,i[p+E[T]]),f=D(f,0<=(o=T)&&o<=15?0:16<=o&&o<=31?1518500249:32<=o&&o<=47?1859775393:48<=o&&o<=63?2400959708:64<=o&&o<=79?2840853838:"rmd160_K1: j out of range"),f=D(P(f,A[T]),m),c=m,m=y,y=P(g,10),g=l,l=f,f=D(d,S(79-T,v,B,F)),f=D(f,i[p+q[T]]),f=D(f,0<=(r=T)&&r<=15?1352829926:16<=r&&r<=31?1548603684:32<=r&&r<=47?1836072691:48<=r&&r<=63?2053994217:64<=r&&r<=79?0:"rmd160_K2: j out of range"),f=D(P(f,C[T]),b),d=b,b=F,F=P(B,10),B=v,v=f;f=D(s,D(g,F)),s=D(u,D(y,b)),u=D(h,D(m,d)),h=D(a,D(c,v)),a=D(n,D(l,B)),n=f}return[n,s,u,h,a]};var E=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],q=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],A=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],C=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];function D(t,i){var e=(65535&t)+(65535&i);return(t>>16)+(i>>16)+(e>>16)<<16|65535&e}function P(t,i){return t<<i|t>>>32-i}}(),function(){var e=window.SecureRandom=function(){};if(e.state,e.pool,e.pptr,e.poolSize=256,e.prototype.nextBytes=function(t){for(var i=0;i<t.length;++i)t[i]=e.getByte()},e.seedTime=function(){e.seedInt((new Date).getTime())},e.getByte=function(){if(null==e.state){for(e.seedTime(),e.state=e.ArcFour(),e.state.init(e.pool),e.pptr=0;e.pptr<e.pool.length;++e.pptr)e.pool[e.pptr]=0;e.pptr=0}return e.state.next()},e.seedInt=function(t){e.pool[e.pptr++]^=255&t,e.pool[e.pptr++]^=t>>8&255,e.pool[e.pptr++]^=t>>16&255,e.pool[e.pptr++]^=t>>24&255,e.pptr>=e.poolSize&&(e.pptr-=e.poolSize)},e.ArcFour=function(){function t(){this.i=0,this.j=0,this.S=new Array}return t.prototype.init=function(t){for(var i,e,r=0;r<256;++r)this.S[r]=r;for(r=i=0;r<256;++r)i=i+this.S[r]+t[r%t.length]&255,e=this.S[r],this.S[r]=this.S[i],this.S[i]=e;this.i=0,this.j=0},t.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]},new t},null==e.pool){if(e.pool=new Array,e.pptr=0,"Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto)for(var t=window.crypto.random(32),i=0;i<t.length;++i)e.pool[e.pptr++]=255&t.charCodeAt(i);for(;e.pptr<e.poolSize;)i=Math.floor(65536*Math.random()),e.pool[e.pptr++]=i>>>8,e.pool[e.pptr++]=255&i;e.pptr=0,e.seedTime(),e.seedInt(window.screenX),e.seedInt(window.screenY)}}(),function(){var l=window.EllipticCurve=function(){};l.FieldElementFp=function(t,i){this.x=i,this.q=t},l.FieldElementFp.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},l.FieldElementFp.prototype.toBigInteger=function(){return this.x},l.FieldElementFp.prototype.negate=function(){return new l.FieldElementFp(this.q,this.x.negate().mod(this.q))},l.FieldElementFp.prototype.add=function(t){return new l.FieldElementFp(this.q,this.x.add(t.toBigInteger()).mod(this.q))},l.FieldElementFp.prototype.subtract=function(t){return new l.FieldElementFp(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},l.FieldElementFp.prototype.multiply=function(t){return new l.FieldElementFp(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},l.FieldElementFp.prototype.square=function(){return new l.FieldElementFp(this.q,this.x.square().mod(this.q))},l.FieldElementFp.prototype.divide=function(t){return new l.FieldElementFp(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},l.FieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},l.FieldElementFp.prototype.sqrt=function(){if(!this.q.testBit(0))throw new Error("even value of q");if(this.q.testBit(1)){var t=new l.FieldElementFp(this.q,this.x.modPow(this.q.shiftRight(2).add(BigInteger.ONE),this.q));return t.square().equals(this)?t:null}var i=this.q.subtract(BigInteger.ONE),e=i.shiftRight(1);if(!this.x.modPow(e,this.q).equals(BigInteger.ONE))return null;var r=i.shiftRight(2).shiftLeft(1).add(BigInteger.ONE),o=this.x,n=o.shiftLeft(2).mod(this.q);do{for(var s,u=new SecureRandom;0<=(s=new BigInteger(this.q.bitLength(),u)).compareTo(this.q)||!s.multiply(s).subtract(n).modPow(e,this.q).equals(i););var h,a=l.FieldElementFp.fastLucasSequence(this.q,s,o,r),p=a[0];if((h=a[1]).multiply(h).mod(this.q).equals(n))return h.testBit(0)&&(h=h.add(this.q)),h=h.shiftRight(1),new l.FieldElementFp(this.q,h)}while(p.equals(BigInteger.ONE)||p.equals(i));return null},l.FieldElementFp.fastLucasSequence=function(t,i,e,r){for(var o=r.bitLength(),n=r.getLowestSetBit(),s=BigInteger.ONE,u=BigInteger.TWO,h=i,a=BigInteger.ONE,p=BigInteger.ONE,f=o-1;n+1<=f;--f)a=a.multiply(p).mod(t),r.testBit(f)?(p=a.multiply(e).mod(t),s=s.multiply(h).mod(t),u=h.multiply(u).subtract(i.multiply(a)).mod(t),h=h.multiply(h).subtract(p.shiftLeft(1)).mod(t)):(p=a,s=s.multiply(u).subtract(a).mod(t),h=h.multiply(u).subtract(i.multiply(a)).mod(t),u=u.multiply(u).subtract(a.shiftLeft(1)).mod(t));p=(a=a.multiply(p).mod(t)).multiply(e).mod(t),s=s.multiply(u).subtract(a).mod(t),u=h.multiply(u).subtract(i.multiply(a)).mod(t),a=a.multiply(p).mod(t);for(f=1;f<=n;++f)s=s.multiply(u).mod(t),u=u.multiply(u).subtract(a.shiftLeft(1)).mod(t),a=a.multiply(a).mod(t);return[s,u]},l.PointFp=function(t,i,e,r,o){this.curve=t,this.x=i,this.y=e,this.z=null==r?BigInteger.ONE:r,this.zinv=null,this.compressed=!!o},l.PointFp.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},l.PointFp.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},l.PointFp.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(BigInteger.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(BigInteger.ZERO))},l.PointFp.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)},l.PointFp.prototype.negate=function(){return new l.PointFp(this.curve,this.x,this.y.negate(),this.z)},l.PointFp.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var i=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),e=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(e))return BigInteger.ZERO.equals(i)?this.twice():this.curve.getInfinity();var r=new BigInteger("3"),o=this.x.toBigInteger(),n=this.y.toBigInteger(),s=(t.x.toBigInteger(),t.y.toBigInteger(),e.square()),u=s.multiply(e),h=o.multiply(s),a=i.square().multiply(this.z),p=a.subtract(h.shiftLeft(1)).multiply(t.z).subtract(u).multiply(e).mod(this.curve.q),f=h.multiply(r).multiply(i).subtract(n.multiply(u)).subtract(a.multiply(i)).multiply(t.z).add(i.multiply(u)).mod(this.curve.q),c=u.multiply(this.z).multiply(t.z).mod(this.curve.q);return new l.PointFp(this.curve,this.curve.fromBigInteger(p),this.curve.fromBigInteger(f),c)},l.PointFp.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=new BigInteger("3"),i=this.x.toBigInteger(),e=this.y.toBigInteger(),r=e.multiply(this.z),o=r.multiply(e).mod(this.curve.q),n=this.curve.a.toBigInteger(),s=i.square().multiply(t);BigInteger.ZERO.equals(n)||(s=s.add(this.z.square().multiply(n)));var u=(s=s.mod(this.curve.q)).square().subtract(i.shiftLeft(3).multiply(o)).shiftLeft(1).multiply(r).mod(this.curve.q),h=s.multiply(t).multiply(i).subtract(o.shiftLeft(1)).shiftLeft(2).multiply(o).subtract(s.square().multiply(s)).mod(this.curve.q),a=r.square().multiply(r).shiftLeft(3).mod(this.curve.q);return new l.PointFp(this.curve,this.curve.fromBigInteger(u),this.curve.fromBigInteger(h),a)},l.PointFp.prototype.multiply=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();for(var i=t,e=i.multiply(new BigInteger("3")),r=this.negate(),o=this,n=e.bitLength()-2;0<n;--n){o=o.twice();var s=e.testBit(n);s!=i.testBit(n)&&(o=o.add(s?this:r))}return o},l.PointFp.prototype.multiplyTwo=function(t,i,e){for(var r=t.bitLength()>e.bitLength()?t.bitLength()-1:e.bitLength()-1,o=this.curve.getInfinity(),n=this.add(i);0<=r;)o=o.twice(),t.testBit(r)?o=e.testBit(r)?o.add(n):o.add(this):e.testBit(r)&&(o=o.add(i)),--r;return o},l.PointFp.prototype.getEncoded=function(t){var i=this.getX().toBigInteger(),e=this.getY().toBigInteger(),r=l.integerToBytes(i,32);return t?e.isEven()?r.unshift(2):r.unshift(3):(r.unshift(4),r=r.concat(l.integerToBytes(e,32))),r},l.PointFp.decodeFrom=function(t,i){i[0];var e=i.length-1,r=i.slice(1,1+e/2),o=i.slice(1+e/2,1+e);r.unshift(0),o.unshift(0);var n=new BigInteger(r),s=new BigInteger(o);return new l.PointFp(t,t.fromBigInteger(n),t.fromBigInteger(s))},l.PointFp.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var i=t.x.subtract(this.x),e=t.y.subtract(this.y).divide(i),r=e.square().subtract(this.x).subtract(t.x),o=e.multiply(this.x.subtract(r)).subtract(this.y);return new l.PointFp(this.curve,r,o)},l.PointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=this.curve.fromBigInteger(BigInteger.valueOf(2)),i=this.curve.fromBigInteger(BigInteger.valueOf(3)),e=this.x.square().multiply(i).add(this.curve.a).divide(this.y.multiply(t)),r=e.square().subtract(this.x.multiply(t)),o=e.multiply(this.x.subtract(r)).subtract(this.y);return new l.PointFp(this.curve,r,o)},l.PointFp.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();for(var i=t,e=i.multiply(new BigInteger("3")),r=this.negate(),o=this,n=e.bitLength()-2;0<n;--n){o=o.twice();var s=e.testBit(n);s!=i.testBit(n)&&(o=o.add2D(s?this:r))}return o},l.PointFp.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),i=this.getY().toBigInteger(),e=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),o=this.curve.getQ(),n=i.multiply(i).mod(o),s=t.multiply(t).multiply(t).add(e.multiply(t)).add(r).mod(o);return n.equals(s)},l.PointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},l.PointFp.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var i=this.getX().toBigInteger(),e=this.getY().toBigInteger();if(i.compareTo(BigInteger.ONE)<0||0<i.compareTo(t.subtract(BigInteger.ONE)))throw new Error("x coordinate out of bounds");if(e.compareTo(BigInteger.ONE)<0||0<e.compareTo(t.subtract(BigInteger.ONE)))throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0},l.CurveFp=function(t,i,e){this.q=t,this.a=this.fromBigInteger(i),this.b=this.fromBigInteger(e),this.infinity=new l.PointFp(this,null,null)},l.CurveFp.prototype.getQ=function(){return this.q},l.CurveFp.prototype.getA=function(){return this.a},l.CurveFp.prototype.getB=function(){return this.b},l.CurveFp.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},l.CurveFp.prototype.getInfinity=function(){return this.infinity},l.CurveFp.prototype.fromBigInteger=function(t){return new l.FieldElementFp(this.q,t)},l.CurveFp.prototype.decodePointHex=function(t){var i=parseInt(t.substr(0,2),16);switch(i){case 0:return this.infinity;case 2:case 3:var e=1&i,r=t.substr(2,t.length-2),o=new BigInteger(r,16);return this.decompressPoint(e,o);case 4:case 6:case 7:var n=(t.length-2)/2,r=t.substr(2,n),s=t.substr(2+n,n);return new l.PointFp(this,this.fromBigInteger(new BigInteger(r,16)),this.fromBigInteger(new BigInteger(s,16)));default:return null}},l.CurveFp.prototype.decompressPoint=function(t,i){var e=this.fromBigInteger(i),r=e.multiply(e.square().add(this.getA())).add(this.getB()).sqrt();if(null==r)throw new Error("Invalid point compression");var o=r.toBigInteger();return(o.testBit(0)?1:0)!=t&&(r=this.fromBigInteger(this.getQ().subtract(o))),new l.PointFp(this,e,r,null,!0)},l.fromHex=function(t){return new BigInteger(t,16)},l.integerToBytes=function(t,i){var e=t.toByteArrayUnsigned();if(i<e.length)e=e.slice(e.length-i);else for(;i>e.length;)e.unshift(0);return e},l.X9Parameters=function(t,i,e,r){this.curve=t,this.g=i,this.n=e,this.h=r},l.X9Parameters.prototype.getCurve=function(){return this.curve},l.X9Parameters.prototype.getG=function(){return this.g},l.X9Parameters.prototype.getN=function(){return this.n},l.X9Parameters.prototype.getH=function(){return this.h},l.secNamedCurves={secp256k1:function(){var t=l.fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),i=BigInteger.ZERO,e=l.fromHex("7"),r=l.fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),o=BigInteger.ONE,n=new l.CurveFp(t,i,e),s=n.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new l.X9Parameters(n,s,r,o)}},l.getSECCurveByName=function(t){return null==l.secNamedCurves[t]?null:l.secNamedCurves[t]()}}(),function(){var t,B=window.BigInteger=function(t,i,e){null!=t&&("number"==typeof t?this.fromNumber(t,i,e):null==i&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,i))};function F(){return new B(null)}t="Microsoft Internet Explorer"==navigator.appName?(B.prototype.am=function(t,i,e,r,o,n){for(var s=32767&i,u=i>>15;0<=--n;){var h=32767&this[t],a=this[t++]>>15,p=u*h+a*s;o=((h=s*h+((32767&p)<<15)+e[r]+(1073741823&o))>>>30)+(p>>>15)+u*a+(o>>>30),e[r++]=1073741823&h}return o},30):"Netscape"!=navigator.appName?(B.prototype.am=function(t,i,e,r,o,n){for(;0<=--n;){var s=i*this[t++]+e[r]+o;o=Math.floor(s/67108864),e[r++]=67108863&s}return o},26):(B.prototype.am=function(t,i,e,r,o,n){for(var s=16383&i,u=i>>14;0<=--n;){var h=16383&this[t],a=this[t++]>>14,p=u*h+a*s;o=((h=s*h+((16383&p)<<14)+e[r]+o)>>28)+(p>>14)+u*a,e[r++]=268435455&h}return o},28),B.prototype.DB=t,B.prototype.DM=(1<<t)-1,B.prototype.DV=1<<t;B.prototype.FV=Math.pow(2,52),B.prototype.F1=52-t,B.prototype.F2=2*t-52;for(var r=new Array,i="0".charCodeAt(0),e=0;e<=9;++e)r[i++]=e;for(i="a".charCodeAt(0),e=10;e<36;++e)r[i++]=e;for(i="A".charCodeAt(0),e=10;e<36;++e)r[i++]=e;function h(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function a(t,i){var e=r[t.charCodeAt(i)];return null==e?-1:e}function m(t){var i=F();return i.fromInt(t),i}function b(t){var i,e=1;return 0!=(i=t>>>16)&&(t=i,e+=16),0!=(i=t>>8)&&(t=i,e+=8),0!=(i=t>>4)&&(t=i,e+=4),0!=(i=t>>2)&&(t=i,e+=2),0!=(i=t>>1)&&(t=i,e+=1),e}B.prototype.copyTo=function(t){for(var i=this.t-1;0<=i;--i)t[i]=this[i];t.t=this.t,t.s=this.s},B.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,0<t?this[0]=t:t<-1?this[0]=t+DV:this.t=0},B.prototype.fromString=function(t,i){var e;if(16==i)e=4;else if(8==i)e=3;else if(256==i)e=8;else if(2==i)e=1;else if(32==i)e=5;else{if(4!=i)return void this.fromRadix(t,i);e=2}this.t=0,this.s=0;for(var r=t.length,o=!1,n=0;0<=--r;){var s=8==e?255&t[r]:a(t,r);s<0?"-"==t.charAt(r)&&(o=!0):(o=!1,0==n?this[this.t++]=s:n+e>this.DB?(this[this.t-1]|=(s&(1<<this.DB-n)-1)<<n,this[this.t++]=s>>this.DB-n):this[this.t-1]|=s<<n,(n+=e)>=this.DB&&(n-=this.DB))}8==e&&0!=(128&t[0])&&(this.s=-1,0<n&&(this[this.t-1]|=(1<<this.DB-n)-1<<n)),this.clamp(),o&&B.ZERO.subTo(this,this)},B.prototype.clamp=function(){for(var t=this.s&this.DM;0<this.t&&this[this.t-1]==t;)--this.t},B.prototype.dlShiftTo=function(t,i){for(var e=this.t-1;0<=e;--e)i[e+t]=this[e];for(e=t-1;0<=e;--e)i[e]=0;i.t=this.t+t,i.s=this.s},B.prototype.drShiftTo=function(t,i){for(var e=t;e<this.t;++e)i[e-t]=this[e];i.t=Math.max(this.t-t,0),i.s=this.s},B.prototype.lShiftTo=function(t,i){for(var e=t%this.DB,r=this.DB-e,o=(1<<r)-1,n=Math.floor(t/this.DB),s=this.s<<e&this.DM,u=this.t-1;0<=u;--u)i[u+n+1]=this[u]>>r|s,s=(this[u]&o)<<e;for(u=n-1;0<=u;--u)i[u]=0;i[n]=s,i.t=this.t+n+1,i.s=this.s,i.clamp()},B.prototype.rShiftTo=function(t,i){i.s=this.s;var e=Math.floor(t/this.DB);if(e>=this.t)i.t=0;else{var r=t%this.DB,o=this.DB-r,n=(1<<r)-1;i[0]=this[e]>>r;for(var s=e+1;s<this.t;++s)i[s-e-1]|=(this[s]&n)<<o,i[s-e]=this[s]>>r;0<r&&(i[this.t-e-1]|=(this.s&n)<<o),i.t=this.t-e,i.clamp()}},B.prototype.subTo=function(t,i){for(var e=0,r=0,o=Math.min(t.t,this.t);e<o;)r+=this[e]-t[e],i[e++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;e<this.t;)r+=this[e],i[e++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e<t.t;)r-=t[e],i[e++]=r&this.DM,r>>=this.DB;r-=t.s}i.s=r<0?-1:0,r<-1?i[e++]=this.DV+r:0<r&&(i[e++]=r),i.t=e,i.clamp()},B.prototype.multiplyTo=function(t,i){var e=this.abs(),r=t.abs(),o=e.t;for(i.t=o+r.t;0<=--o;)i[o]=0;for(o=0;o<r.t;++o)i[o+e.t]=e.am(0,r[o],i,o,0,e.t);i.s=0,i.clamp(),this.s!=t.s&&B.ZERO.subTo(i,i)},B.prototype.squareTo=function(t){for(var i=this.abs(),e=t.t=2*i.t;0<=--e;)t[e]=0;for(e=0;e<i.t-1;++e){var r=i.am(e,i[e],t,2*e,0,1);(t[e+i.t]+=i.am(e+1,2*i[e],t,2*e+1,r,i.t-e-1))>=i.DV&&(t[e+i.t]-=i.DV,t[e+i.t+1]=1)}0<t.t&&(t[t.t-1]+=i.am(e,i[e],t,2*e,0,1)),t.s=0,t.clamp()},B.prototype.divRemTo=function(t,i,e){var r=t.abs();if(!(r.t<=0)){var o=this.abs();if(o.t<r.t)return null!=i&&i.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=F());var n=F(),s=this.s,u=t.s,h=this.DB-b(r[r.t-1]);0<h?(r.lShiftTo(h,n),o.lShiftTo(h,e)):(r.copyTo(n),o.copyTo(e));var a=n.t,p=n[a-1];if(0!=p){var f=p*(1<<this.F1)+(1<a?n[a-2]>>this.F2:0),c=this.FV/f,l=(1<<this.F1)/f,g=1<<this.F2,y=e.t,m=y-a,d=null==i?F():i;for(n.dlShiftTo(m,d),0<=e.compareTo(d)&&(e[e.t++]=1,e.subTo(d,e)),B.ONE.dlShiftTo(a,d),d.subTo(n,n);n.t<a;)n[n.t++]=0;for(;0<=--m;){var v=e[--y]==p?this.DM:Math.floor(e[y]*c+(e[y-1]+g)*l);if((e[y]+=n.am(0,v,e,m,0,a))<v)for(n.dlShiftTo(m,d),e.subTo(d,e);e[y]<--v;)e.subTo(d,e)}null!=i&&(e.drShiftTo(a,i),s!=u&&B.ZERO.subTo(i,i)),e.t=a,e.clamp(),0<h&&e.rShiftTo(h,e),s<0&&B.ZERO.subTo(e,e)}}},B.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var i=3&t;return 0<(i=(i=(i=(i=i*(2-(15&t)*i)&15)*(2-(255&t)*i)&255)*(2-((65535&t)*i&65535))&65535)*(2-t*i%this.DV)%this.DV)?this.DV-i:-i},B.prototype.isEven=function(){return 0==(0<this.t?1&this[0]:this.s)},B.prototype.exp=function(t,i){if(4294967295<t||t<1)return B.ONE;var e,r=F(),o=F(),n=i.convert(this),s=b(t)-1;for(n.copyTo(r);0<=--s;){i.sqrTo(r,o),0<(t&1<<s)?i.mulTo(o,n,r):(e=r,r=o,o=e)}return i.revert(r)},B.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return this.toRadix(t);i=2}var e,r=(1<<i)-1,o=!1,n="",s=this.t,u=this.DB-s*this.DB%i;if(0<s--)for(u<this.DB&&0<(e=this[s]>>u)&&(o=!0,n=h(e));0<=s;)u<i?(e=(this[s]&(1<<u)-1)<<i-u,e|=this[--s]>>(u+=this.DB-i)):(e=this[s]>>(u-=i)&r,u<=0&&(u+=this.DB,--s)),0<e&&(o=!0),o&&(n+=h(e));return o?n:"0"},B.prototype.negate=function(){var t=F();return B.ZERO.subTo(this,t),t},B.prototype.abs=function(){return this.s<0?this.negate():this},B.prototype.compareTo=function(t){var i=this.s-t.s;if(0!=i)return i;var e=this.t;if(0!=(i=e-t.t))return this.s<0?-i:i;for(;0<=--e;)if(0!=(i=this[e]-t[e]))return i;return 0},B.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+b(this[this.t-1]^this.s&this.DM)},B.prototype.mod=function(t){var i=F();return this.abs().divRemTo(t,null,i),this.s<0&&0<i.compareTo(B.ZERO)&&t.subTo(i,i),i},B.prototype.modPowInt=function(t,i){var e=new(t<256||i.isEven()?d:v)(i);return this.exp(t,e)},B.ZERO=m(0),B.ONE=m(1);var p=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],n=(1<<26)/p[p.length-1];function o(t,i){return t&i}function s(t,i){return t|i}function u(t,i){return t^i}function f(t,i){return t&~i}function d(t){this.m=t}function v(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function c(){}function T(t){this.r2=F(),this.q3=F(),B.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}B.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},B.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||36<t)return"0";var i=this.chunkSize(t),e=Math.pow(t,i),r=m(e),o=F(),n=F(),s="";for(this.divRemTo(r,o,n);0<o.signum();)s=(e+n.intValue()).toString(t).substr(1)+s,o.divRemTo(r,o,n);return n.intValue().toString(t)+s},B.prototype.fromRadix=function(t,i){this.fromInt(0),null==i&&(i=10);for(var e=this.chunkSize(i),r=Math.pow(i,e),o=!1,n=0,s=0,u=0;u<t.length;++u){var h=a(t,u);h<0?"-"==t.charAt(u)&&0==this.signum()&&(o=!0):(s=i*s+h,++n>=e&&(this.dMultiply(r),this.dAddOffset(s,0),s=n=0))}0<n&&(this.dMultiply(Math.pow(i,n)),this.dAddOffset(s,0)),o&&B.ZERO.subTo(this,this)},B.prototype.fromNumber=function(t,i,e){if("number"==typeof i)if(t<2)this.fromInt(1);else for(this.fromNumber(t,e),this.testBit(t-1)||this.bitwiseTo(B.ONE.shiftLeft(t-1),s,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(B.ONE.shiftLeft(t-1),this);else{var r=new Array,o=7&t;r.length=1+(t>>3),i.nextBytes(r),0<o?r[0]&=(1<<o)-1:r[0]=0,this.fromString(r,256)}},B.prototype.bitwiseTo=function(t,i,e){for(var r,o=Math.min(t.t,this.t),n=0;n<o;++n)e[n]=i(this[n],t[n]);if(t.t<this.t){for(r=t.s&this.DM,n=o;n<this.t;++n)e[n]=i(this[n],r);e.t=this.t}else{for(r=this.s&this.DM,n=o;n<t.t;++n)e[n]=i(r,t[n]);e.t=t.t}e.s=i(this.s,t.s),e.clamp()},B.prototype.changeBit=function(t,i){var e=B.ONE.shiftLeft(t);return this.bitwiseTo(e,i,e),e},B.prototype.addTo=function(t,i){for(var e=0,r=0,o=Math.min(t.t,this.t);e<o;)r+=this[e]+t[e],i[e++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;e<this.t;)r+=this[e],i[e++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e<t.t;)r+=t[e],i[e++]=r&this.DM,r>>=this.DB;r+=t.s}i.s=r<0?-1:0,0<r?i[e++]=r:r<-1&&(i[e++]=this.DV+r),i.t=e,i.clamp()},B.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},B.prototype.dAddOffset=function(t,i){if(0!=t){for(;this.t<=i;)this[this.t++]=0;for(this[i]+=t;this[i]>=this.DV;)this[i]-=this.DV,++i>=this.t&&(this[this.t++]=0),++this[i]}},B.prototype.multiplyLowerTo=function(t,i,e){var r,o=Math.min(this.t+t.t,i);for(e.s=0,e.t=o;0<o;)e[--o]=0;for(r=e.t-this.t;o<r;++o)e[o+this.t]=this.am(0,t[o],e,o,0,this.t);for(r=Math.min(t.t,i);o<r;++o)this.am(0,t[o],e,o,0,i-o);e.clamp()},B.prototype.multiplyUpperTo=function(t,i,e){--i;var r=e.t=this.t+t.t-i;for(e.s=0;0<=--r;)e[r]=0;for(r=Math.max(i-this.t,0);r<t.t;++r)e[this.t+r-i]=this.am(i-r,t[r],e,0,0,this.t+r-i);e.clamp(),e.drShiftTo(1,e)},B.prototype.modInt=function(t){if(t<=0)return 0;var i=this.DV%t,e=this.s<0?t-1:0;if(0<this.t)if(0==i)e=this[0]%t;else for(var r=this.t-1;0<=r;--r)e=(i*e+this[r])%t;return e},B.prototype.millerRabin=function(t){var i=this.subtract(B.ONE),e=i.getLowestSetBit();if(e<=0)return!1;var r=i.shiftRight(e);p.length<(t=t+1>>1)&&(t=p.length);for(var o=F(),n=0;n<t;++n){o.fromInt(p[Math.floor(Math.random()*p.length)]);var s=o.modPow(r,this);if(0!=s.compareTo(B.ONE)&&0!=s.compareTo(i)){for(var u=1;u++<e&&0!=s.compareTo(i);)if(0==(s=s.modPowInt(2,this)).compareTo(B.ONE))return!1;if(0!=s.compareTo(i))return!1}}return!0},B.prototype.clone=function(){var t=F();return this.copyTo(t),t},B.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},B.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},B.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},B.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},B.prototype.toByteArray=function(){var t=this.t,i=new Array;i[0]=this.s;var e,r=this.DB-t*this.DB%8,o=0;if(0<t--)for(r<this.DB&&(e=this[t]>>r)!=(this.s&this.DM)>>r&&(i[o++]=e|this.s<<this.DB-r);0<=t;)r<8?(e=(this[t]&(1<<r)-1)<<8-r,e|=this[--t]>>(r+=this.DB-8)):(e=this[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),0!=(128&e)&&(e|=-256),0==o&&(128&this.s)!=(128&e)&&++o,(0<o||e!=this.s)&&(i[o++]=e);return i},B.prototype.equals=function(t){return 0==this.compareTo(t)},B.prototype.min=function(t){return this.compareTo(t)<0?this:t},B.prototype.max=function(t){return 0<this.compareTo(t)?this:t},B.prototype.and=function(t){var i=F();return this.bitwiseTo(t,o,i),i},B.prototype.or=function(t){var i=F();return this.bitwiseTo(t,s,i),i},B.prototype.xor=function(t){var i=F();return this.bitwiseTo(t,u,i),i},B.prototype.andNot=function(t){var i=F();return this.bitwiseTo(t,f,i),i},B.prototype.not=function(){for(var t=F(),i=0;i<this.t;++i)t[i]=this.DM&~this[i];return t.t=this.t,t.s=~this.s,t},B.prototype.shiftLeft=function(t){var i=F();return t<0?this.rShiftTo(-t,i):this.lShiftTo(t,i),i},B.prototype.shiftRight=function(t){var i=F();return t<0?this.lShiftTo(-t,i):this.rShiftTo(t,i),i},B.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+function(t){if(0==t)return-1;var i=0;return 0==(65535&t)&&(t>>=16,i+=16),0==(255&t)&&(t>>=8,i+=8),0==(15&t)&&(t>>=4,i+=4),0==(3&t)&&(t>>=2,i+=2),0==(1&t)&&++i,i}(this[t]);return this.s<0?this.t*this.DB:-1},B.prototype.bitCount=function(){for(var t=0,i=this.s&this.DM,e=0;e<this.t;++e)t+=function(t){for(var i=0;0!=t;)t&=t-1,++i;return i}(this[e]^i);return t},B.prototype.testBit=function(t){var i=Math.floor(t/this.DB);return i>=this.t?0!=this.s:0!=(this[i]&1<<t%this.DB)},B.prototype.setBit=function(t){return this.changeBit(t,s)},B.prototype.clearBit=function(t){return this.changeBit(t,f)},B.prototype.flipBit=function(t){return this.changeBit(t,u)},B.prototype.add=function(t){var i=F();return this.addTo(t,i),i},B.prototype.subtract=function(t){var i=F();return this.subTo(t,i),i},B.prototype.multiply=function(t){var i=F();return this.multiplyTo(t,i),i},B.prototype.divide=function(t){var i=F();return this.divRemTo(t,i,null),i},B.prototype.remainder=function(t){var i=F();return this.divRemTo(t,null,i),i},B.prototype.divideAndRemainder=function(t){var i=F(),e=F();return this.divRemTo(t,i,e),new Array(i,e)},B.prototype.modPow=function(t,i){var e,r,o=t.bitLength(),n=m(1);if(o<=0)return n;e=o<18?1:o<48?3:o<144?4:o<768?5:6,r=new(o<8?d:i.isEven()?T:v)(i);var s=new Array,u=3,h=e-1,a=(1<<e)-1;if(s[1]=r.convert(this),1<e){var p=F();for(r.sqrTo(s[1],p);u<=a;)s[u]=F(),r.mulTo(p,s[u-2],s[u]),u+=2}for(var f,c,l=t.t-1,g=!0,y=F(),o=b(t[l])-1;0<=l;){for(h<=o?f=t[l]>>o-h&a:(f=(t[l]&(1<<o+1)-1)<<h-o,0<l&&(f|=t[l-1]>>this.DB+o-h)),u=e;0==(1&f);)f>>=1,--u;if((o-=u)<0&&(o+=this.DB,--l),g)s[f].copyTo(n),g=!1;else{for(;1<u;)r.sqrTo(n,y),r.sqrTo(y,n),u-=2;0<u?r.sqrTo(n,y):(c=n,n=y,y=c),r.mulTo(y,s[f],n)}for(;0<=l&&0==(t[l]&1<<o);)r.sqrTo(n,y),c=n,n=y,y=c,--o<0&&(o=this.DB-1,--l)}return r.revert(n)},B.prototype.modInverse=function(t){var i=t.isEven();if(this.isEven()&&i||0==t.signum())return B.ZERO;for(var e=t.clone(),r=this.clone(),o=m(1),n=m(0),s=m(0),u=m(1);0!=e.signum();){for(;e.isEven();)e.rShiftTo(1,e),i?(o.isEven()&&n.isEven()||(o.addTo(this,o),n.subTo(t,n)),o.rShiftTo(1,o)):n.isEven()||n.subTo(t,n),n.rShiftTo(1,n);for(;r.isEven();)r.rShiftTo(1,r),i?(s.isEven()&&u.isEven()||(s.addTo(this,s),u.subTo(t,u)),s.rShiftTo(1,s)):u.isEven()||u.subTo(t,u),u.rShiftTo(1,u);0<=e.compareTo(r)?(e.subTo(r,e),i&&o.subTo(s,o),n.subTo(u,n)):(r.subTo(e,r),i&&s.subTo(o,s),u.subTo(n,u))}return 0!=r.compareTo(B.ONE)?B.ZERO:0<=u.compareTo(t)?u.subtract(t):u.signum()<0?(u.addTo(t,u),u.signum()<0?u.add(t):u):u},B.prototype.pow=function(t){return this.exp(t,new c)},B.prototype.gcd=function(t){var i,e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();e.compareTo(r)<0&&(i=e,e=r,r=i);var o=e.getLowestSetBit(),n=r.getLowestSetBit();if(n<0)return e;for(o<n&&(n=o),0<n&&(e.rShiftTo(n,e),r.rShiftTo(n,r));0<e.signum();)0<(o=e.getLowestSetBit())&&e.rShiftTo(o,e),0<(o=r.getLowestSetBit())&&r.rShiftTo(o,r),0<=e.compareTo(r)?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return 0<n&&r.lShiftTo(n,r),r},B.prototype.isProbablePrime=function(t){var i,e=this.abs();if(1==e.t&&e[0]<=p[p.length-1]){for(i=0;i<p.length;++i)if(e[0]==p[i])return!0;return!1}if(e.isEven())return!1;for(i=1;i<p.length;){for(var r=p[i],o=i+1;o<p.length&&r<n;)r*=p[o++];for(r=e.modInt(r);i<o;)if(r%p[i++]==0)return!1}return e.millerRabin(t)},B.prototype.square=function(){var t=F();return this.squareTo(t),t},B.valueOf=m,B.prototype.toByteArrayUnsigned=function(){var t=this.abs().toByteArray();return t.length?(0==t[0]&&(t=t.slice(1)),t.map(function(t){return t<0?t+256:t})):t},B.fromByteArrayUnsigned=function(t){return t.length?128&t[0]?new B([0].concat(t)):new B(t):t.valueOf(0)},B.prototype.toByteArraySigned=function(){var t=this.abs().toByteArrayUnsigned();return this.compareTo(B.ZERO)<0?128&t[0]?t.unshift(128):t[0]|=128:128&t[0]&&t.unshift(0),t},B.fromByteArraySigned=function(t){return 128&t[0]?(t[0]&=127,B.fromByteArrayUnsigned(t).negate()):B.fromByteArrayUnsigned(t)},d.prototype.convert=function(t){return t.s<0||0<=t.compareTo(this.m)?t.mod(this.m):t},d.prototype.revert=function(t){return t},d.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},d.prototype.mulTo=function(t,i,e){t.multiplyTo(i,e),this.reduce(e)},d.prototype.sqrTo=function(t,i){t.squareTo(i),this.reduce(i)},v.prototype.convert=function(t){var i=F();return t.abs().dlShiftTo(this.m.t,i),i.divRemTo(this.m,null,i),t.s<0&&0<i.compareTo(B.ZERO)&&this.m.subTo(i,i),i},v.prototype.revert=function(t){var i=F();return t.copyTo(i),this.reduce(i),i},v.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var i=0;i<this.m.t;++i){var e=32767&t[i],r=e*this.mpl+((e*this.mph+(t[i]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[e=i+this.m.t]+=this.m.am(0,r,t,i,0,this.m.t);t[e]>=t.DV;)t[e]-=t.DV,t[++e]++}t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)},v.prototype.mulTo=function(t,i,e){t.multiplyTo(i,e),this.reduce(e)},v.prototype.sqrTo=function(t,i){t.squareTo(i),this.reduce(i)},c.prototype.convert=function(t){return t},c.prototype.revert=function(t){return t},c.prototype.mulTo=function(t,i,e){t.multiplyTo(i,e)},c.prototype.sqrTo=function(t,i){t.squareTo(i)},T.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var i=F();return t.copyTo(i),this.reduce(i),i},T.prototype.revert=function(t){return t},T.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);0<=t.compareTo(this.m);)t.subTo(this.m,t)},T.prototype.mulTo=function(t,i,e){t.multiplyTo(i,e),this.reduce(e)},T.prototype.sqrTo=function(t,i){t.squareTo(i),this.reduce(i)}}(),"object"==typeof module||(window.Bitcoin={}),function(t){t.Base58={alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",validRegex:/^[1-9A-HJ-NP-Za-km-z]+$/,base:BigInteger.valueOf(58),encode:function(t){for(var i=BigInteger.fromByteArrayUnsigned(t),e=[];0<=i.compareTo(s.base);){var r=i.mod(s.base);e.unshift(s.alphabet[r.intValue()]),i=i.subtract(r).divide(s.base)}e.unshift(s.alphabet[i.intValue()]);for(var o=0;o<t.length&&0==t[o];o++)e.unshift(s.alphabet[0]);return e.join("")},decode:function(t){for(var i=BigInteger.valueOf(0),e=0,r=t.length-1;0<=r;r--){var o=s.alphabet.indexOf(t[r]);if(o<0)throw"Invalid character";i=i.add(BigInteger.valueOf(o).multiply(s.base.pow(t.length-1-r))),"1"==t[r]?e++:e=0}for(var n=i.toByteArrayUnsigned();0<e--;)n.unshift(0);return n}};var s=t.Base58}("undefined"!=typeof Bitcoin?Bitcoin:module.exports),Bitcoin.Address=function(t){"string"==typeof t&&(t=Bitcoin.Address.decodeString(t)),this.hash=t,this.version=Bitcoin.Address.networkVersion},Bitcoin.Address.networkVersion=30,Bitcoin.Address.prototype.toString=function(){var t=this.hash.slice(0);t.unshift(this.version);var i=Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0}),e=t.concat(i.slice(0,4));return Bitcoin.Base58.encode(e)},Bitcoin.Address.prototype.getHashBase64=function(){return Crypto.util.bytesToBase64(this.hash)},Bitcoin.Address.decodeString=function(t){var i=Bitcoin.Base58.decode(t),e=i.slice(0,21),r=Crypto.SHA256(Crypto.SHA256(e,{asBytes:!0}),{asBytes:!0});if(r[0]!=i[21]||r[1]!=i[22]||r[2]!=i[23]||r[3]!=i[24])throw"Checksum validation failed!";var o=e.shift();if(0!=o)throw"Version "+o+" not supported!";return e},Bitcoin.ECDSA=function(){var b=EllipticCurve.getSECCurveByName("secp256k1"),i=new SecureRandom,T=null;var I={getBigRandom:function(t){return new BigInteger(t.bitLength(),i).mod(t.subtract(BigInteger.ONE)).add(BigInteger.ONE)},sign:function(t,i){var e=i,r=b.getN(),o=BigInteger.fromByteArrayUnsigned(t);do{var n=I.getBigRandom(r),s=b.getG().multiply(n).getX().toBigInteger().mod(r)}while(s.compareTo(BigInteger.ZERO)<=0);var u=n.modInverse(r).multiply(o.add(e.multiply(s))).mod(r);return I.serializeSig(s,u)},verify:function(t,i,e){var r;if(Bitcoin.Util.isArray(i))var o=I.parseSig(i),n=o.r,s=o.s;else{if("object"!=typeof i||!i.r||!i.s)throw"Invalid value for signature";n=i.r,s=i.s}if(e instanceof ec.PointFp)r=e;else{if(!Bitcoin.Util.isArray(e))throw"Invalid format for pubkey value, must be byte array or ec.PointFp";r=EllipticCurve.PointFp.decodeFrom(b.getCurve(),e)}var u=BigInteger.fromByteArrayUnsigned(t);return I.verifyRaw(u,n,s,r)},verifyRaw:function(t,i,e,r){var o=b.getN(),n=b.getG();if(i.compareTo(BigInteger.ONE)<0||0<=i.compareTo(o))return!1;if(e.compareTo(BigInteger.ONE)<0||0<=e.compareTo(o))return!1;var s=e.modInverse(o),u=t.multiply(s).mod(o),h=i.multiply(s).mod(o);return n.multiply(u).add(r.multiply(h)).getX().toBigInteger().mod(o).equals(i)},serializeSig:function(t,i){var e=t.toByteArraySigned(),r=i.toByteArraySigned(),o=[];return o.push(2),o.push(e.length),(o=o.concat(e)).push(2),o.push(r.length),(o=o.concat(r)).unshift(o.length),o.unshift(48),o},parseSig:function(t){var i;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if((i=2)!=t[i])throw new Error("First element in signature must be a DERInteger");var e=t.slice(i+2,i+2+t[i+1]);if(2!=t[i+=2+t[i+1]])throw new Error("Second element in signature must be a DERInteger");var r=t.slice(i+2,i+2+t[i+1]);return i+=2+t[i+1],{r:BigInteger.fromByteArrayUnsigned(e),s:BigInteger.fromByteArrayUnsigned(r)}},parseSigCompact:function(t){if(65!==t.length)throw"Signature has the wrong length";var i=t[0]-27;if(i<0||7<i)throw"Invalid signature type";var e=b.getN();return{r:BigInteger.fromByteArrayUnsigned(t.slice(1,33)).mod(e),s:BigInteger.fromByteArrayUnsigned(t.slice(33,65)).mod(e),i:i}},recoverPubKey:function(t,i,e,r){var o=1&(r&=3),n=r>>1,s=b.getN(),u=b.getG(),h=b.getCurve(),a=h.getQ(),p=h.getA().toBigInteger(),f=h.getB().toBigInteger();T=T||a.add(BigInteger.ONE).divide(BigInteger.valueOf(4));var c=n?t.add(s):t,l=c.multiply(c).multiply(c).add(p.multiply(c)).add(f).mod(a).modPow(T,a),g=(l.isEven(),(l.isEven()?!o:o)?l:a.subtract(l)),y=new EllipticCurve.PointFp(h,h.fromBigInteger(c),h.fromBigInteger(g));y.validate();var m=BigInteger.fromByteArrayUnsigned(e),d=BigInteger.ZERO.subtract(m).mod(s),v=t.modInverse(s),B=function(t,i,e,r){for(var o=Math.max(i.bitLength(),r.bitLength()),n=t.add2D(e),s=t.curve.getInfinity(),u=o-1;0<=u;--u)(s=s.twice2D()).z=BigInteger.ONE,i.testBit(u)?s=r.testBit(u)?s.add2D(n):s.add2D(t):r.testBit(u)&&(s=s.add2D(e));return s}(y,i,u,d).multiply(v);if(B.validate(),!I.verifyRaw(m,t,i,B))throw"Pubkey recovery unsuccessful";var F=new Bitcoin.ECKey;return F.pub=B,F},calcPubkeyRecoveryParam:function(t,i,e,r){for(var o=0;o<4;o++)try{if(Bitcoin.ECDSA.recoverPubKey(i,e,r,o).getBitcoinAddress().toString()==t)return o}catch(t){}throw"Unable to find valid recovery factor"}};return I}(),Bitcoin.ECKey=function(){var r=Bitcoin.ECDSA,o=EllipticCurve.getSECCurveByName("secp256k1"),n=(new SecureRandom,function(t){var i,e;t?t instanceof BigInteger?this.priv=t:Bitcoin.Util.isArray(t)?this.priv=BigInteger.fromByteArrayUnsigned(t):"string"==typeof t&&(i=null,n.isWalletImportFormat(t)?(i=n.decodeWalletImportFormat(t),this.compressed=!1):n.isCompressedWalletImportFormat(t)?(i=n.decodeCompressedWalletImportFormat(t),this.compressed=!0):n.isMiniFormat(t)?i=Crypto.SHA256(t,{asBytes:!0}):n.isHexFormat(t)?i=Crypto.util.hexToBytes(t):n.isBase64Format(t)&&(i=Crypto.util.base64ToBytes(t)),null==i||32!=i.length?this.priv=null:this.priv=BigInteger.fromByteArrayUnsigned(i)):(e=o.getN(),this.priv=r.getBigRandom(e)),this.compressed=null==this.compressed?!!n.compressByDefault:this.compressed});return n.privateKeyPrefix=158,n.compressByDefault=!0,n.prototype.setCompressed=function(t){return this.compressed=!!t,this.pubPoint&&(this.pubPoint.compressed=this.compressed),this},n.prototype.getPub=function(){return this.compressed?this.pubComp?this.pubComp:this.pubComp=this.getPubPoint().getEncoded(1):this.pubUncomp?this.pubUncomp:this.pubUncomp=this.getPubPoint().getEncoded(0)},n.prototype.getPubPoint=function(){return this.pubPoint||(this.pubPoint=o.getG().multiply(this.priv),this.pubPoint.compressed=this.compressed),this.pubPoint},n.prototype.getPubKeyHex=function(){return this.compressed?this.pubKeyHexComp?this.pubKeyHexComp:this.pubKeyHexComp=Crypto.util.bytesToHex(this.getPub()).toString().toUpperCase():this.pubKeyHexUncomp?this.pubKeyHexUncomp:this.pubKeyHexUncomp=Crypto.util.bytesToHex(this.getPub()).toString().toUpperCase()},n.prototype.getPubKeyHash=function(){return this.compressed?this.pubKeyHashComp?this.pubKeyHashComp:this.pubKeyHashComp=Bitcoin.Util.sha256ripe160(this.getPub()):this.pubKeyHashUncomp?this.pubKeyHashUncomp:this.pubKeyHashUncomp=Bitcoin.Util.sha256ripe160(this.getPub())},n.prototype.getBitcoinAddress=function(){var t=this.getPubKeyHash();return new Bitcoin.Address(t).toString()},n.prototype.setPub=function(t){Bitcoin.Util.isArray(t)&&(t=Crypto.util.bytesToHex(t).toString().toUpperCase());var i=o.getCurve().decodePointHex(t);return this.setCompressed(i.compressed),this.pubPoint=i,this},n.prototype.getBitcoinWalletImportFormat=function(){(i=this.getBitcoinPrivateKeyByteArray()).unshift(n.privateKeyPrefix),this.compressed&&i.push(1);var t=Crypto.SHA256(Crypto.SHA256(i,{asBytes:!0}),{asBytes:!0}),i=i.concat(t.slice(0,4));return Bitcoin.Base58.encode(i)},n.prototype.getBitcoinHexFormat=function(){return Crypto.util.bytesToHex(this.getBitcoinPrivateKeyByteArray()).toString().toUpperCase()},n.prototype.getBitcoinBase64Format=function(){return Crypto.util.bytesToBase64(this.getBitcoinPrivateKeyByteArray())},n.prototype.getBitcoinPrivateKeyByteArray=function(){for(var t=this.priv.toByteArrayUnsigned();t.length<32;)t.unshift(0);return t},n.prototype.toString=function(t){return"base64"==(t=t||"").toString().toLowerCase()||"b64"==t.toString().toLowerCase()?this.getBitcoinBase64Format():"wif"==t.toString().toLowerCase()?this.getBitcoinWalletImportFormat():this.getBitcoinHexFormat()},n.prototype.sign=function(t){return r.sign(t,this.priv)},n.prototype.verify=function(t,i){return r.verify(t,i,this.getPub())},n.decodeWalletImportFormat=function(t){var i=Bitcoin.Base58.decode(t),e=i.slice(0,33),r=Crypto.SHA256(Crypto.SHA256(e,{asBytes:!0}),{asBytes:!0});if(r[0]!=i[33]||r[1]!=i[34]||r[2]!=i[35]||r[3]!=i[36])throw"Checksum validation failed!";var o=e.shift();if(o!=n.privateKeyPrefix)throw"Version "+o+" not supported!";return e},n.decodeCompressedWalletImportFormat=function(t){var i=Bitcoin.Base58.decode(t),e=i.slice(0,34),r=Crypto.SHA256(Crypto.SHA256(e,{asBytes:!0}),{asBytes:!0});if(r[0]!=i[34]||r[1]!=i[35]||r[2]!=i[36]||r[3]!=i[37])throw"Checksum validation failed!";var o=e.shift();if(o!=n.privateKeyPrefix)throw"Version "+o+" not supported!";return e.pop(),e},n.isHexFormat=function(t){return t=t.toString(),/^[A-Fa-f0-9]{64}$/.test(t)},n.isWalletImportFormat=function(t){return t=t.toString(),/^9[UVW][123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{49}$/.test(t)},n.isCompressedWalletImportFormat=function(t){return t=t.toString(),/^e[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{51}$/.test(t)},n.isBase64Format=function(t){return t=t.toString(),/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789=+\/]{44}$/.test(t)},n.isMiniFormat=function(t){t=t.toString();var i=/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{21}$/.test(t),e=/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{25}$/.test(t),r=/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{29}$/.test(t),o=Crypto.SHA256(t+"?",{asBytes:!0});return(0===o[0]||1===o[0])&&(i||e||r)},n}(),Bitcoin.Util={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},makeFilledArray:function(t,i){for(var e=[],r=0;r<t;)e[r++]=i;return e},numToVarInt:function(t){return t<253?[t]:t<=65536?[253,t>>>8,255&t]:t<=1?[254].concat(Crypto.util.wordsToBytes([t])):[255].concat(Crypto.util.wordsToBytes([t>>>32,t]))},valueToBigInt:function(t){return t instanceof BigInteger?t:BigInteger.fromByteArrayUnsigned(t)},formatValue:function(t){for(var i=this.valueToBigInt(t).toString(),e=8<i.length?i.substr(0,i.length-8):"0",r=8<i.length?i.substr(i.length-8):i;r.length<8;)r="0"+r;for(r=r.replace(/0*$/,"");r.length<2;)r+="0";return e+"."+r},parseValue:function(t){for(var i=t.split("."),e=i[0],r=i[1]||"0";r.length<8;)r+="0";r=r.replace(/^0+/g,"");var o=BigInteger.valueOf(parseInt(e));return o=(o=o.multiply(BigInteger.valueOf(1e8))).add(BigInteger.valueOf(parseInt(r)))},sha256ripe160:function(t){return Crypto.RIPEMD160(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0})},dsha256:function(t){return Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0})}};var mini2wif=function(){var t,i=document.getElementById("minikey").value;Bitcoin.ECKey.isMiniFormat(i)?(t=new Bitcoin.ECKey(i),document.getElementById("wifkey").innerHTML="<h3 class='text-muted'>Private Key (WIF)</h3><br />"+t.getBitcoinWalletImportFormat(),document.getElementById("address").innerHTML="<h3 class='text-muted'>Innova Address</h3><br />"+t.getBitcoinAddress()):alert("Error: key provided is not a valid Minikey")};